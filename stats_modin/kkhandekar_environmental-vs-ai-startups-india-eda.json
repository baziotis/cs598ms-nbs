{
  "cells": [
    {
      "raw": "import numpy as np # linear algebra\nimport os\n\nimport os\nos.environ[\"MODIN_ENGINE\"] = \"ray\"\nimport ray\nos.environ['MODIN_CPUS'] = \"4\"\nray.init(num_cpus=4, runtime_env={'env_vars': {'__MODIN_AUTOIMPORT_PANDAS__': '1'}})\nimport modin.pandas as pd\n\n# Visualisation\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots",
      "total-ns": 6351081843
    },
    {
      "raw": "# load & cleanup\nfile = '../input/indian-startup-recognized-by-dpiit/Startup_Counts_Across_India.csv'\ndf = pd.read_csv(file)",
      "total-ns": 6761093296
    },
    {
      "raw": "factor = 3000\ndf = pd.concat([df]*factor)\ndf.info()",
      "total-ns": 14438359016
    },
    {
      "raw": "df.drop('S No.',axis=1,inplace=True)\ndf.dropna(inplace=True)\ndf.reset_index(inplace=True,drop=True)\n\n#view\ndf.head()",
      "total-ns": 11422088591
    },
    {
      "raw": "# %%time\n# Industry sub-categories for environmental & AI startups\nenv = ['Agriculture','Green Technology','Renewable Energy','Waste Management']\nai = ['AI','Robotics','Computer Vision']\n\n# combined df - environmental & AI startups only\ndf_ea = df.loc[(df['Industry'].isin(env)) | (df['Industry'].isin(ai))].reset_index(drop=True,inplace=False)\n\n# custom function to set Main Industry\ndef set_MainIndustry(ind):\n    if ind in env:\n        return 'ENV'\n    else:\n        return 'AI'\n\n# adding a new column\ndf_ea['MainIndustry'] = df_ea.Industry.apply(lambda x: set_MainIndustry(x))\n\n# basic stats\nprint(f\"A total of {df_ea.shape[0]} startups were started in India between 2016 & 2022, out of which {df_ea.groupby('MainIndustry').size()['ENV']} are environmental related & {df_ea.groupby('MainIndustry').size()['AI']} are AI startups.\")",
      "total-ns": 11100420857
    }
  ]
}